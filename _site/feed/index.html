<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
        xmlns:content="http://purl.org/rss/1.0/modules/content/"
        xmlns:atom="http://www.w3.org/2005/Atom"
  >
  <channel>
    <title>Spatial-R</title>
    <atom:link href="http://spatial-r.github.io/cn/feed/" rel="self" type="application/rss+xml" />
    <link>http://chengjun.github.io</link>
    <lastBuildDate>2015-03-31T16:50:16+08:00</lastBuildDate>
    <webMaster>wangchj04@gmail.com</webMaster>
    
    <item>
      <title>时空统计模型(一)：空间统计</title>
      <link>http://spatial-r.github.io/cn/2015/01/Spatial-and-Spatial-temporal/</link>
      <pubDate>2015-01-25T00:00:00+08:00</pubDate>
      <author>Spatial-R</author>
      <guid>http://spatial-r.github.io/cn/2015/01/Spatial-and-Spatial-temporal</guid>
      <content:encoded><![CDATA[<p>接触空间统计学已有近3年了，从毕设开始，得知R在空间统计方面的优势后，毅然扎进”Spatial”和”R”的世界里，Spatial-R的名称应运而生。我从不夸大空间统计学和R软件在我研究生时候的贡献，但自己对于这两样宝贝的热爱，却也不是其他东西能够比拟的。书呆子的生活自是如此，乐此不疲。</p>

<p>还是进入正题，这次主要讨论的主题是空间统计学和时空数据模型等，当然，全部是基于R来实现。因篇幅有限，在此只给大概思路，感兴趣的朋友可以进一步探讨(邮箱：<a href="zhangbing4502431@outlook.com">zhangbing4502431@outlook.com</a>)。</p>

<hr />

<p>国际上已广泛建立了传染病的早期预警平台，但主要是针对症状监测，相比于传统的病例监测，症状监测可以更早期地探测到特定传染病的发生和发展趋势。我国已经建立较为完善的传染病病例监测系统(如传染病疫情信息网络直报系统，俗称“大疫情系统”)，通过病例数据探索传染病传播过程中的异常，并及时采取相应的应对措施，可以有效降低传染病所带来的危害。</p>

<hr />

<h2 id="section">空间统计</h2>

<p>空间统计其实是个很宽泛的概念，世间万物都有其空间属性，但并不代表都能用空间统计学去诠释。当然，也有很多原本不存在明显空间熟悉的事物，我们可以将其转换成或者理解成具有空间属性。这里所强调的，也就是不仅仅只有带有经纬度属性的事物才具备空间数据。</p>

<p>目前在公共卫生领域比较常见的两类是：点数据和面数据。点数据比如传染病的发病地点；面数据比如各个区县的发病总人数。针对点数据，主要是来探讨空间点格局分布进而探讨可能的热点区域；而面数据更多是建立空间回归模型，如空间滞后模型，空间杜宾模型等。当然，空间点数据也可以建立空间回归模型，空间权重的选择往往成为头疼的话题(多大的带宽或者阈值距离最合适)。面数据也可以用以探讨热点，但其揭示的热点往往有点泛(如整个区县是热点，公共卫生的意义并不大)。</p>

<hr />

<h3 id="section-1">热点探测</h3>

<p>地方病、传染病及环境污染所致疾病均可表现出空间聚集性，而传染病在传播途径、流行机制等方面的特殊性决定了其病例的分布特征与其他疾病存在较大差异，其空间属性主要体现在<strong>空间自相关</strong>(空间依赖性)和<strong>空间异质性</strong>。空间自相关性表现为目标地区与邻近地区发病水平及特征较强，与距离远的地区差异大，空间异质性表现为不同地区因为其”位置”原因而存在差异。</p>

<p>公共卫生(Public Health)中较为常见的是病例个案(也就是点数据)，记录着病例个案详细的地址信息。因而在热点探测时，需将详细地址信息转换成经纬度信息。因Google地图API被封，我们可以借助百度地图API，具体操作的方式可参考我的博文(<a href="http://spatial-r.github.io/en/2014/06/Two-ways-to-get-coordinate-data/">点点</a>)。</p>

<p>获取经纬度信息后，则可利用R中的DCluster程序包和Spatsta程序包分别进行热点探测(Cluster Dectecting)和点格局分析(Pattern Analysis)。热点探测也叫聚集性分析，主要包括全局检验和局部检验。顾名思义，全局检验是看疾病在整体或者全局水平上是否具有聚集性，而不管聚集点分布在何处；而局部检验则从底层去探讨和发现可能存在的局部热点。全局聚集性探测可采用<strong>Knox</strong>和 <strong>Rogerson</strong> 等方法，局部聚集性探测则可采用<strong>Turnbull</strong>、<strong>Besag-Newell</strong> 和 <strong>时空扫描</strong> 等方法。  </p>

<hr />

<h4 id="section-2">全局性热点探测</h4>

<hr />

<h5 id="knox">Knox</h5>
<p>Knox，最早也最为经典的全局检验方法(1964由统计学家E.G.Knox提出来，用以检验疾病的时空交互作用)，能充分利用病例的时空信息，不需要人口学数据，计算简便。基本原理如下：</p>

<pre><code>    病例两两配对，然后设定时间和空间临界值，以此标准来判断病例对间距离是"近"还是"远"。
    若时间和空间距离均为"近"的病例对与期望值的差异具有统计意义，则该区域内该病存在时空聚集性。
</code></pre>

<p>假设n个病例，则可配成N=n*(n-1)/2个病例对子，如果知道了每个个案的发病时间和发病位置，则可计算每个病例对之间的空间距离和时间距离。在定义了时间界值(t)和空间界值(s)后，Nt则为时间距离为近的病例对子总数，Ns则为空间距离较近的病例对子总数，X是时间距离和空间距离均为近的病例对子总数，也就是Knox方法的统计检验量，可得到如下的四格表：</p>

<pre><code>   | 时间距离       | &lt;s             | &gt;s    |  合计  | 
   | ------------- |:-------------: | -----:|  :--:  |   
   | &lt;t            |    X           | b     |   Nt   |
   | &gt;t            | c              |   d   |    Nt1 |  
   | 合计           | Ns             |  NS1  |    n   |    
</code></pre>

<p><strong>统计推断方法包括</strong>：   </p>

<ul>
  <li><strong>卡方检验</strong>：样本量较大时，可采用卡方检验，对Knox方法而言，其本身要求设定的空间临界值足够小，因而X样本量偏小的情况较常见。</li>
  <li><strong>Possion估计法</strong>：当Nt和Ns相对于N来说较小时，X的方差接近于它的均数，此时可采用Possion估计法。但当Nt和Ns较大时，使用该方法进行推断时会有偏性。</li>
  <li><strong>基于Possion分布的估计法</strong>：与Possion估计法相似，其以<strong>正态分布</strong>代替Possion分布，一般当u&gt;20时，Possion分布近似正态分布。</li>
  <li><strong>Barton-David</strong>: 仍假设X服从正态分布，但当Ns和Nt较大时，仍能进行无偏推断。</li>
  <li><strong>蒙特卡罗法</strong>：一种无偏的估计方法，目前较好地能够进行Knox检验。</li>
</ul>

<p><strong>时间、空间临界值的确定</strong>：</p>

<ul>
  <li>已知疾病信息，时间界值可按照设为其潜伏期天数，空间界值可设定为相邻农场的距离。</li>
  <li>未知疾病信息，可设置一系列时间界值和空间界值，分别对各个组合进行检验。需注意时间界值和空间界值的设定不能超过其所有病例对子的平均时间距离或平均空间距离(平均时间距离=所有病例对子的时间间隔之和/病例对子总数，平均空间距离=所有病例对子的空间距离之和/病例对子总和)</li>
</ul>

<hr />

<h5 id="rogerson">Rogerson</h5>
<p><strong>Rogerson</strong>，能对传染病的时空进行动态监测，可利用历史数据和不同传染病的危害程度来调整参数和报警界值，有效降低漏报和误报。基本原理如下：  </p>

<pre><code>    在Tango方法的基础上，将样本按n个单位进行分割，使得Zi呈正态或者接近正态。  
</code></pre>

<hr />

<p>未完待续</p>

]]></content:encoded>
    </item>
    
    <item>
      <title>美人鱼</title>
      <link>http://spatial-r.github.io/cn/2014/08/mermaid/</link>
      <pubDate>2014-08-03T00:00:00+08:00</pubDate>
      <author>Spatial-R</author>
      <guid>http://spatial-r.github.io/cn/2014/08/mermaid</guid>
      <content:encoded><![CDATA[<hr />
<p>我是渔夫，          <br />
在日暮之时，映着夕阳， <br />
渴望再次听一曲她的赞歌。</p>

<hr />
<p>辽阔寂静的海边，有人在贮视， <br />
那片他早已熟悉的区域． <br />
他的思绪，浸润在海风中， <br />
一直飘，一直飘… <br />
直至消散在海天相接的地方， <br />
他想，那地方，很美吧．</p>

<hr />
<p>那天，天也是这般蓝，<br />
蓝得只允许人去陶醉．<br />
他，静静地望着夕阳，<br />
望着夕阳在海天相接的地方点点消散．<br />
蓦然，一丝乐符渗进他的耳际，<br />
他的心，猛然地被拉紧．   </p>

<hr />

<p>是谁，在夕阳下如此轻柔地歌唱 <br />
是谁，在海边为他带来了如此动人的乐章 <br />
是谁，又是谁…<br />
转身，从容却又那么迫不及待． <br />
那是一条融在夕阳里的美人鱼， <br />
一条他只能选择远望的美人鱼．   </p>

<hr />
<p>她，高贵地立在海面上， <br />
忘我般演绎着一首生命的赞歌，<br />
这，是他见过的最美的风景， <br />
这，是他永生都忘记不了的记忆． <br />
她，依旧在醉然地歌唱，  <br />
他，依旧在醉然地聆听．   </p>

<hr />

<p>多久，他不知道． <br />
只是，歌声渐渐地飘渺，变淡， <br />
最后，淡的他只能听见海风的呼啸． <br />
他才觉悟地猛然抬头， <br />
她，游走了，向着海天相交的地方， <br />
向着那个他认为最美的地方．  </p>

<hr />

<p>天，依旧那么蓝． <br />
等待着，伴随间歇有力的涛声． <br />
尽管他并不知道，这一次，下一次，<br />
她，是否会出现； <br />
尽管他已经知道，很多次，很多次， <br />
她，都没有出现．</p>

<hr />

<p>夕阳隐没在海天的地方，<br />
他，又望望了那片熟悉的区域， <br />
默然间扎进了海中…</p>

<hr />

<p>09年写的小诗，无意中想起，过去的岁月，总是这样让人放不下。渔夫是孤独的，但却一如既往地守着自己的梦，有梦的生活，是幸福的。</p>

<p><img src="https://i.imgur.com/a3u3nI4.jpg" alt="Drawing" style="width: 500px;" class="alignleft" />   </p>
]]></content:encoded>
    </item>
    
    <item>
      <title>印象西湖和大运河</title>
      <link>http://spatial-r.github.io/cn/2014/08/Riding-in-Hang-zhou/</link>
      <pubDate>2014-08-01T00:00:00+08:00</pubDate>
      <author>Spatial-R</author>
      <guid>http://spatial-r.github.io/cn/2014/08/Riding-in-Hang-zhou</guid>
      <content:encoded><![CDATA[<p>人们常说，“上有天堂，下有苏杭”。<a href="http://baike.sogou.com/v256673.htm">西湖</a>和<a href="http://baike.sogou.com/v15769.htm?sp=SST%E4%BA%AC%E6%9D%AD%E5%A4%A7%E8%BF%90%E6%B2%B3">京杭大运河</a>则为杭州市两张主打的名片。来杭三次，在此地工作已近一月，都未曾一睹其芳容，只缘时机不适，是羞涩，是忐忑，还是觉得等了千年的那个女子未曾到来，不忍只身过断桥?</p>

<p>恰逢七夕，与好友兼同学兼同事兼室友(头衔有点多)组队看西湖和大运河。骑上车，“七夕”也就抛脑后。由滨江经复兴大桥，然后直驱杭州市区到达京杭大运河的南终点——拱宸桥。   </p>

<blockquote>
  <p>碧云天，绿叶地，夏色连片，片上知了醉。清风几许如何，一醉到天明！      </p>
</blockquote>

<p><img src="https://i.imgur.com/I8dRAyP.jpg" alt="Drawing" style="width: 400px;" class="alignleft" />   </p>

<hr />
<p><a href="http://baike.baidu.com/view/552989.htm?fromtitle=%E5%A4%8D%E5%85%B4%E5%A4%A7%E6%A1%A5&amp;fromid=8798773&amp;type=syn">复兴大桥</a>相比于<a href="http://baike.baidu.com/view/16154.htm">武汉长江大桥</a>，略显娇小，尽管两者的主桥长度相近(分别为1156米和1145米)，但武汉长江大桥略显霸气的引桥，是复兴大桥无法比拟的；同时，复兴大桥距水面较近，这也使得其气势大减。个人很钟爱武汉长江大桥，感觉就是一种宿命。在武汉七年，不管是同学过来游玩还是带老师参观，都会去武汉长江大桥上走走，看看长江，也感受下武汉敢为人先的魄力(各种怀念啊)。人虽离开武汉，但牵挂依旧在，只等哪天，再次带着闲暇的心境，去走走那“万里长江第一桥”。复兴大桥和钱塘江大桥的人行道都很窄，使得骑车让道变得很有技术含量，个人技术不行，一听到后面的喇叭声，立马停车靠边，心中还有些许忐忑。三座大桥的夜景都很nice，走走看看，都是一种享受！</p>

<hr />
<p>骑车2小时后，到达京杭大运河。作为世界里程最长、工程最大的古代运河，与<a href="http://baike.baidu.com/subview/2203/6173557.htm">长城</a>、<a href="http://baike.baidu.com/view/2942.htm">坎儿井</a>并称为中国古代三项伟大工程沿着大运河。继西湖申遗成功后，2014年6月，中国大运河成功入选世界文化遗产名录，为杭州这座六朝古都，又添上了一抹浓重的文化气息。沿着大运河慢走，绿树，垂柳，行人几许，生活极尽舒坦。这不由地让我想起了著有“天府之国”之称的成都，同样有2处世遗(<a href="http://baike.baidu.com/subview/2240/12000340.htm">都江堰</a>和<a href="http://baike.baidu.com/view/539806.htm">大熊猫栖息地</a>),也是极尽休闲的旅游城市。依然怀念柳絮纷飞的季节，在桥边静坐，喝茶，看云卷云舒，听小巧流水，品人来人往，心静地没有一点瑕疵。不知何时，在杭州也能重现那时的心境，洒脱地连自己都能忽略。   </p>

<p><img src="http://i.imgur.com/rBl0yUt.jpg" alt="Drawing" style="width: 370px;" class="alignleft" />   </p>

<hr />
<p>终点站，往往是姗姗来迟。拱宸桥对于杭州人的意义不一般，但对于我们这样的“东飘者”，只是一座带有杭州特色的古桥而已。旁边的中国刀剪剑博物馆、中国扇博物馆和中国伞博物馆都因时间太晚，早已打烊。在各种里弄里穿梭，终寻得一宁静之处，吆喝一声，开始晚餐，只可惜，晓甫的减盐项目再次受挑战，看来，口味重的人，要想健康生活，真不容易。   </p>

<hr />
<p>往回走，早已夜色弥漫，灯火通明的街道，行人都在往家的方向赶！六年前，也是和晓甫他们在夜色中穿梭，闯红灯，赶速度，看着自行车和小车之间的”亲密接触”,各种不文明的行为，在杭州很是收敛。夜逛西湖，繁华热闹的苏堤在九点还是人声鼎沸，上坡，下坡，再上坡，再下坡…淡妆的西子，只能用心去感受，还好有明月相伴，至少不那么落寞。行程匆匆，没有细看，也没有细品，只缘自己知道，还会再来。</p>
]]></content:encoded>
    </item>
    
  </channel>
</rss>
